# OpenShift Network Override Example
# Demonstrates how to override default base networking configuration

project: "openshift-network-override"
location: "us-east-1"

# Instance definitions using instances
instances:
  web_tier:
    count: 3
    image: "rhel8-latest"
    size: "medium"
    region: "us-east-1"

# OpenShift cluster definitions
openshift_clusters:
  - name: "rosa-with-custom-networking"
    type: "rosa-classic"
    region: "us-east-1"
    version: "4.14.15"
    size: "medium"
    
    # Override default networking configuration
    networking:
      # Override the default machine CIDR (default: 10.0.0.0/16)
      machine_cidr: "192.168.0.0/16"
      
      # Override the default service CIDR (default: 172.30.0.0/16)  
      service_cidr: "172.31.0.0/16"
      
      # Keep default pod CIDR (10.128.0.0/14) - not specified so uses default
      # pod_cidr: "10.128.0.0/14"  # This would be the default
      
      # Override default host prefix (default: 23)
      host_prefix: 24
    
    # Machine pool configuration
    machine_pools:
      - name: "custom-workers"
        replicas: 3
        min_replicas: 2
        max_replicas: 6
        instance_type: "m5.xlarge"
        
  - name: "aro-with-custom-subnets"
    type: "aro"
    region: "East US"
    version: "4.14.15"
    size: "small"
    
    # Override Azure-specific networking defaults
    networking:
      # Override default vnet CIDR (default: 10.1.0.0/16)
      vnet_cidr: "10.10.0.0/16"
      
      # Override default master subnet CIDR (default: 10.1.0.0/24)
      master_subnet_cidr: "10.10.1.0/24"
      
      # Override default worker subnet CIDR (default: 10.1.1.0/24)
      worker_subnet_cidr: "10.10.2.0/24"
      
      # Override OpenShift service CIDR
      service_cidr: "172.32.0.0/16"
      
      # Override OpenShift pod CIDR
      pod_cidr: "10.129.0.0/14"
    
  - name: "self-managed-gcp-custom"
    type: "self-managed"
    provider: "gcp"
    region: "us-central1"
    version: "4.14.15" 
    size: "large"
    
    # Override self-managed networking defaults
    networking:
      # Override default machine CIDR (default: 10.2.0.0/16)
      machine_cidr: "10.50.0.0/16"
      
      # Custom OpenShift networking
      service_cidr: "172.33.0.0/16"
      pod_cidr: "10.130.0.0/14"
      host_prefix: 22
      
    masters:
      count: 3
      instance_type: "n1-standard-8"
      
    workers:
      count: 5
      instance_type: "n1-standard-16"

# Applications (using default networking - no overrides needed)
openshift_applications:
  - name: "web-app"
    type: "kubernetes"
    target_clusters: ["rosa-with-custom-networking"]
    namespace: "web-tier"
    
    resources:
      - type: "Deployment"
        spec:
          replicas: 3
          selector:
            matchLabels:
              app: "web-app"
          template:
            metadata:
              labels:
                app: "web-app"
            spec:
              containers:
              - name: "web"
                image: "nginx:latest"
                ports:
                - containerPort: 80
                  
      - type: "Service"
        metadata:
          name: "web-service"
        spec:
          selector:
            app: "web-app"
          ports:
          - port: 80
            targetPort: 80
          type: "ClusterIP" 