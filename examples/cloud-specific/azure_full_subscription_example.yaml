---
# Azure Full Subscription Example
# Demonstrates using the entire Azure subscription with automatic resource group creation
# This is YamlForge's default behavior for Azure deployments

guid: "full01"

yamlforge:
  cloud_workspace:
    name: "full-subscription-deployment"
    description: "Multi-region deployment with full subscription access"
  
  # Azure Configuration: Use entire subscription (default behavior)
  # azure:
  #   use_existing_resource_group: false  # This is the default, no need to specify
  
  # NOTE: YamlForge will automatically create resource groups per region
  # Resource groups will be named: {workspace-name}-{region}
  # Example: "full-subscription-deployment-eastus", "full-subscription-deployment-westus2"

  instances:
    # Web servers in East US (will create new resource group)
    - name: "web-eastus"
      provider: "azure"
      size: "medium"
      image: "RHEL9-latest"
      region: "eastus"
      tags:
        tier: "web"
        environment: "production"
        zone: "east"
    
    # Web servers in West US (will create separate resource group)
    - name: "web-westus"
      provider: "azure"
      size: "medium"
      image: "RHEL9-latest"
      region: "westus2"
      tags:
        tier: "web"
        environment: "production"
        zone: "west"
    
    # Database server in East US (uses same RG as web-eastus)
    - name: "db-eastus"
      provider: "azure"
      size: "xlarge"
      image: "RHEL9-latest"
      region: "eastus"
      tags:
        tier: "database"
        environment: "production"
        zone: "east"
    
    # Application server in Central US (will create third resource group)
    - name: "app-central"
      provider: "azure"
      size: "large"
      image: "RHEL9-latest"
      region: "centralus"
      tags:
        tier: "application"
        environment: "production"
        zone: "central"

  # Security groups (will be created as Azure NSGs in each resource group)
  security_groups:
    - name: "web-access"
      description: "Web server access rules"
      rules:
        - direction: "ingress"
          protocol: "tcp"
          port_range: "80"
          source: "0.0.0.0/0"
        - direction: "ingress"
          protocol: "tcp"
          port_range: "443"
          source: "0.0.0.0/0"
        - direction: "ingress"
          protocol: "tcp"
          port_range: "22"
          source: "10.0.0.0/8"

    - name: "app-access"
      description: "Application server access rules"
      rules:
        - direction: "ingress"
          protocol: "tcp"
          port_range: "8080"
          source: "10.0.0.0/16"
        - direction: "ingress"
          protocol: "tcp"
          port_range: "22"
          source: "10.0.0.0/8"

    - name: "db-access"
      description: "Database server access rules"
      rules:
        - direction: "ingress"
          protocol: "tcp"
          port_range: "3306"
          source: "10.0.0.0/16"
        - direction: "ingress"
          protocol: "tcp"
          port_range: "5432"
          source: "10.0.0.0/16"

  tags:
    deployment_type: "full_subscription"
    managed_by: "yamlforge"
    cost_center: "engineering"
    project: "multi-region-app" 